___

# CarND-Controls-PID
Self-Driving Car Engineer Nanodegree Program

---


## Dependencies

* cmake >= 3.5
 * All OSes: [click here for installation instructions](https://cmake.org/install/)
* make >= 4.1(mac, linux), 3.81(Windows)
  * Mac: [install Xcode command line tools to get make](https://developer.apple.com/xcode/features/)
* gcc/g++ >= 5.4
  * Linux: gcc / g++ is installed by default on most Linux distros
  * Mac: same deal as make - [install Xcode command line tools]((https://developer.apple.com/xcode/features/)
* [uWebSockets](https://github.com/uWebSockets/uWebSockets)
  * Run either `./install-mac.sh` or `./install-ubuntu.sh`.
  * If you install from source, checkout to commit `e94b6e1`, i.e.
    ```
    git clone https://github.com/uWebSockets/uWebSockets 
    cd uWebSockets
    git checkout e94b6e1
    ```
    Some function signatures have changed in v0.14.x. See [this PR](https://github.com/udacity/CarND-MPC-Project/pull/3) for more details.
* Simulator. You can download these from the [project intro page](https://github.com/udacity/self-driving-car-sim/releases) in the classroom.

* Gnuplot-iostream. 
  * You can download gnuplot on Mac: ```brew install gnuplot```
  * For the real-time plot, [gnuplot-iostream](http://stahlke.org/dan/gnuplot-iostream/) is utilized. To retireve the respository, 
  ```
  git clone https://github.com/dstahlke/gnuplot-iostream.git
  ```
  * To compile the [gnuplot-iostream.h](./src/gnuplot-iostream.h), [CMakeLists.txt](./CMakeLists.txt) should be updated to include boost and link such as [How do you add boost libraries in CMakeLists.txt](https://stackoverflow.com/questions/6646405/how-do-you-add-boost-libraries-in-cmakelists-txt) in stackoverflow.

## Basic Build Instructions

1. Clone this repo.
2. Make a build directory: `mkdir build && cd build`
3. Compile: `cmake .. && make`
4. Run it: `./pid`. 

Tips for setting up your environment can be found [here](https://classroom.udacity.com/nanodegrees/nd013/parts/40f38239-66b6-46ec-ae68-03afd8a601c8/modules/0949fca6-b379-42af-a919-ee50aa304e6a/lessons/f758c44c-5e40-4e01-93b5-1a82aa4e044f/concepts/23d376c7-0195-4276-bdf0-e02f1f3c665d)


## Project Rubrics

[//]: # (Image References)

[image1]: ./output/PID_015_0_0.png "PID_0.15_0_0"
[image2]: ./output/PID_015_0_25.png "PID_0.15_0_2.5"
[image3]: ./output/PID_015_0000001_25.png "PID_0.15_0.000001_2.5"

1. **Compilation**:   Your code should compile.

Yes! It is complied with ```cmake``` and ```make```. The ```CMakeLists.txt``` is updated with ```gnuplot-iostream``` to plot the CTE and steering angle time-histories as real-time.

2. **Implementation**: The PID procedure follows what was taught in the lessons.

Yes! Propotional-Integral-Derivative (PID) control systems is included at [PID.cpp](./src/PID.cpp)).

3. **Reflection**(1): Describe the effect each of the P, I, D components had in your implementation.

The proportional term (P) is proporional to the CTE, and makes vehicle oscillate in sinosuidal motion. If CTE is large and positive, the control tem will be proportionaly large and negative. In the control simulation, the vehicle oscillates continously when there is only P term.

![alt text][image1]
  
The derivative term (D) diminishes the the oscillating motion of vehicle. It is generated by the rate of CTE change, and plays a role of damping the errors. In the simulation, the amplitude of CTE is reduced gradually. 

![alt text][image2]
 
Lastly, the integral term (I) tries to get rid of a bias of control system. It eliminates the residual steady-state error. In the simulation, I assigned very small integral term in the simulation. 

![alt text][image3]

4. **Reflection**(2): Describe how the final hyperparameters were chosen.

At first, I tried to set the proportional coefficient, ```Kp``` which cause the vehicle oscillate around the reference line. However, there was overshooting and did not comeback to the target line. 

Secondly, I gradually increased the derivative coefficient, ```Kd``` to damp the oscillation. Finally, I set a small the integral coefficient, ```Ki``` to keep vechile close to the target tragectory.

So, the final parameter is ```[Kp, Ki, Kd] = [0.15, 0.000001, 2.5]```.

Here is the final result [video](./output/PIDControl_015_0000001_25.mov).

